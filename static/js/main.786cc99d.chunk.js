(this.webpackJsonpblogcontroller=this.webpackJsonpblogcontroller||[]).push([[0],{19:function(e,t,c){},29:function(e,t,c){"use strict";c.r(t);var n=c(1),s=c.n(n),a=c(12),i=c.n(a),o=c(2),l=(c(19),c(5)),r=c(0),j=function(e){return Object(r.jsxs)("div",{className:"singlePost",children:[Object(r.jsx)("div",{className:"titleSection",children:e.data.title}),Object(r.jsx)("div",{className:"textSection",children:e.data.text}),Object(r.jsxs)("div",{className:"bottomRow",children:[Object(r.jsxs)("div",{children:["Created: ",e.data.date_formatted]}),Object(r.jsxs)("div",{className:"rightSide bottom",children:[Object(r.jsx)("div",{children:e.data.published?"Published":"Hidden"}),Object(r.jsx)(l.b,{to:"/post/"+e.data._id,className:"buttonLink",children:Object(r.jsx)("span",{children:"View Post"})})]})]})]})},d=function(){var e=Object(n.useState)([]),t=Object(o.a)(e,2),c=t[0],s=t[1],a=Object(n.useState)(!1),i=Object(o.a)(a,2),l=i[0],d=i[1];return Object(n.useEffect)((function(){d(!0),fetch("https://dcblogapi.herokuapp.com/api/post",{credentials:"include"}).then((function(e){return e.json()})).then((function(e){s(e),d(!1)})).catch((function(e){throw new Error("Failed to fetch api")}))}),[]),l?Object(r.jsx)("div",{className:"loading",children:"Loading"}):Object(r.jsx)("div",{className:"homePage",children:0===c.length?Object(r.jsx)("div",{children:"No posts found"}):c.map((function(e){return Object(r.jsx)(j,{data:e})}))})},b=c(3),m=function(){return Object(r.jsxs)("div",{className:"navBar",children:[Object(r.jsx)("div",{className:"logo",children:Object(r.jsx)("div",{children:"Blog Controller"})}),Object(r.jsxs)("div",{className:"navSection",children:[Object(r.jsx)(l.b,{className:"navLink",to:"/",children:Object(r.jsx)("span",{children:"Posts"})}),Object(r.jsx)(l.b,{className:"navLink",to:"/create",children:Object(r.jsx)("span",{children:"Create Post"})}),Object(r.jsx)(l.b,{className:"navLink",to:"/login",children:Object(r.jsx)("span",{children:"Login"})})]})]})},u=function(){var e=Object(n.useRef)(null),t=Object(n.useRef)(null),c=Object(n.useState)(!1),s=Object(o.a)(c,2),a=s[0],i=s[1],l=Object(n.useState)([]),j=Object(o.a)(l,2),d=j[0],m=j[1],u=Object(n.useState)(""),h=Object(o.a)(u,2),O=h[0],p=h[1];return Object(n.useEffect)((function(){""!==O&&i(!0)}),[O]),a?Object(r.jsx)(b.a,{to:"/post/".concat(O)}):Object(r.jsxs)("div",{className:"formContainer",children:[Object(r.jsx)("div",{className:"errorContainer",children:d.map((function(e){return Object(r.jsx)("div",{children:e.msg})}))}),Object(r.jsxs)("form",{className:"submitForm",type:"submit",children:[Object(r.jsx)("div",{className:"title",children:"Create Post"}),Object(r.jsx)("label",{htmlFor:"title",children:"Title"}),Object(r.jsx)("input",{ref:e,type:"text",id:"title",name:"title"}),Object(r.jsx)("label",{htmlFor:"text",children:"Text"}),Object(r.jsx)("textarea",{ref:t,className:"textArea",type:"text",id:"text",name:"text"}),Object(r.jsx)("button",{className:"createBtn",onClick:function(c){c.preventDefault(),fetch("https://dcblogapi.herokuapp.com/api/post",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e.current.value,text:t.current.value})}).then((function(e){return e.json()})).then((function(e){console.log(e),e.errors?m(e.errors):p(e._id)})).catch((function(e){throw new Error(e)}))},type:"submit",children:"Submit"})]})]})},h=function(e){var t=Object(n.useState)({}),c=Object(o.a)(t,2),s=c[0],a=c[1],i=Object(n.useState)([]),j=Object(o.a)(i,2),d=j[0],b=j[1],m=Object(n.useState)([]),u=Object(o.a)(m,2),h=u[0],O=u[1],p=Object(n.useState)(!0),x=Object(o.a)(p,2),f=x[0],v=x[1],N=Object(n.useRef)(null),g=Object(n.useRef)(null);Object(n.useEffect)((function(){var t=fetch("https://dcblogapi.herokuapp.com/api/post/".concat(e.match.params.id),{credentials:"include"}),c=fetch("https://dcblogapi.herokuapp.com/api/post/".concat(e.match.params.id,"/comment"),{credentials:"include"});Promise.all([t,c]).then((function(e){var t=Object(o.a)(e,2),c=t[0],n=t[1];return Promise.all([c.json(),n.json()])})).then((function(e){v(!1),e[0].errors?O(e[0].errors):(a(e[0]),b(e[1]))})).catch((function(e){console.log(e)}))}),[]);return f?Object(r.jsx)("div",{className:"loading",children:"Loading"}):0!==h.length?Object(r.jsx)("div",{children:h}):Object(r.jsxs)("div",{className:"viewContainer",children:[Object(r.jsxs)("div",{className:"viewPost",children:[Object(r.jsxs)("div",{className:"textContainer",children:[Object(r.jsx)("div",{className:"viewTitle",children:s.title}),Object(r.jsx)("div",{className:"viewText",children:s.text})]}),Object(r.jsxs)("div",{className:"viewBottom",children:[Object(r.jsxs)("div",{className:"viewDate",children:["Created: ",s.date_formatted]}),Object(r.jsxs)("div",{className:"viewLinks",children:[Object(r.jsx)(l.b,{to:"/post/".concat(e.match.params.id,"/delete"),className:"buttonLink",children:Object(r.jsx)("span",{children:"Delete Post"})}),Object(r.jsx)(l.b,{to:"/post/".concat(e.match.params.id,"/update"),className:"buttonLink",children:Object(r.jsx)("span",{children:"Update Post"})})]})]})]}),Object(r.jsxs)("div",{className:"viewFormContainer",children:[Object(r.jsx)("div",{className:"commentTag",children:"Create Comment"}),Object(r.jsxs)("form",{className:"createComment",children:[Object(r.jsx)("label",{htmlFor:"name",children:"Name"}),Object(r.jsx)("input",{ref:N,id:"name",name:"name"}),Object(r.jsx)("label",{htmlFor:"text",children:"Text"}),Object(r.jsx)("textarea",{ref:g,id:"text",name:"text"}),Object(r.jsx)("button",{onClick:function(t){t.preventDefault(),fetch("https://dcblogapi.herokuapp.com/api/post/".concat(e.match.params.id,"/comment"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:N.current.value,text:g.current.value,id:e.match.params.id})}).then((function(e){return e.json()})).then((function(e){window.location.reload()})).catch((function(e){console.log(e)}))},className:"buttonLink",children:"Submit Comment"})]})]}),Object(r.jsxs)("div",{className:"commentSection",children:[Object(r.jsx)("div",{className:"commentTag",children:"Comments"}),d.map((function(t,c){return Object(r.jsxs)("div",{className:"comment",children:[Object(r.jsxs)("div",{className:"commentHead",children:[Object(r.jsx)("div",{className:"commentName",children:t.name}),Object(r.jsxs)("div",{className:"commentDate",children:["Submitted: ",t.date_formatted]})]}),Object(r.jsx)("div",{className:"commentText",children:t.text}),Object(r.jsx)(l.b,{to:"/post/".concat(e.match.params.id,"/comment/").concat(t._id),className:"singleDeleteComment",children:Object(r.jsx)("span",{className:"commentRight",children:"Delete Comment"})})]},"comment".concat(c))}))]})]})},O=function(e){console.log(e);var t=Object(n.useRef)(null),c=Object(n.useRef)(null),s=Object(n.useState)([]),a=Object(o.a)(s,2),i=a[0],l=a[1],j=Object(n.useState)(!1),d=Object(o.a)(j,2),m=d[0],u=d[1],h=Object(n.useState)(!1),O=Object(o.a)(h,2),p=O[0],x=O[1];return Object(n.useEffect)((function(){m&&setTimeout((function(){x(!0),e.changeAuth()}),2e3)}),[m]),p||e.auth?Object(r.jsx)(b.a,{to:"/"}):Object(r.jsxs)("form",{className:"loginForm",type:"submit",children:[Object(r.jsx)("div",{className:"successSection",children:m?Object(r.jsx)("div",{children:"Login successful, Redirecting shortly"}):Object(r.jsx)(r.Fragment,{})}),Object(r.jsx)("div",{className:"errorSection",children:i.map((function(e){return Object(r.jsx)("div",{children:e.msg})}))}),Object(r.jsxs)("div",{className:"inputWrapper",children:[Object(r.jsx)("div",{className:"inputHeading",children:"Login"}),Object(r.jsxs)("div",{className:"inputSection",children:[Object(r.jsx)("label",{htmlFor:"username",children:"Username"}),Object(r.jsx)("input",{ref:t,id:"username",name:"username"})]}),Object(r.jsxs)("div",{className:"inputSection",children:[Object(r.jsx)("label",{htmlFor:"password",children:"Password"}),Object(r.jsx)("input",{ref:c,id:"password",name:"password",type:"password"})]}),Object(r.jsx)("button",{className:"submitBtn",onClick:function(e){e.preventDefault(),fetch("https://dcblogapi.herokuapp.com/api/login",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t.current.value,password:c.current.value})}).then((function(e){return e.json()})).then((function(e){e.errors?l(e.errors):(l([]),u(!0))})).catch((function(e){console.log(e)}))},children:"Submit"})]})]})},p=function(e){var t=Object(n.useState)({}),c=Object(o.a)(t,2),s=c[0],a=c[1],i=Object(n.useState)({}),l=Object(o.a)(i,2),j=(l[0],l[1]),d=Object(n.useState)(!1),m=Object(o.a)(d,2),u=m[0],h=m[1],O=Object(n.useState)(!1),p=Object(o.a)(O,2),x=p[0],f=p[1];Object(n.useEffect)((function(){fetch("https://dcblogapi.herokuapp.com/api/post/".concat(e.match.params.id,"/comment/").concat(e.match.params.commentId),{credentials:"include"}).then((function(e){return e.json()})).then((function(e){e.errors?j(e.errors):a(e)})).catch((function(e){console.log(e)}))}),[]);return x?Object(r.jsx)(b.a,{to:"/post/".concat(e.match.params.id)}):Object(r.jsxs)("div",{className:"deleteContainer",children:[Object(r.jsx)("div",{className:"deleteComment",children:Object(r.jsxs)("div",{className:"comment delete",children:[Object(r.jsxs)("div",{className:"commentHead",children:[Object(r.jsx)("div",{className:"commentName",children:s.name}),Object(r.jsxs)("div",{className:"commentDate",children:["Submitted: ",s.date_formatted]})]}),Object(r.jsx)("div",{className:"commentText",children:s.text})]})}),Object(r.jsxs)("div",{className:"deleteSection",children:[Object(r.jsx)("button",{onClick:function(){h(!0)},children:"Delete this comment?"}),u?Object(r.jsxs)("div",{className:"deleteRow",children:[Object(r.jsx)("button",{onClick:function(t){t.preventDefault(),fetch("https://dcblogapi.herokuapp.com/api/post/".concat(e.match.params.id,"/comment/").concat(e.match.params.commentId),{method:"DELETE",credentials:"include"}).then((function(e){return e.json()})).then((function(e){console.log(e),f(!0)})).catch((function(e){console.log(e)}))},children:"Confirm"}),Object(r.jsx)("button",{onClick:function(){h(!1)},children:"Cancel"})]}):Object(r.jsx)(r.Fragment,{})]})]})},x=function(e){var t=Object(n.useState)({}),c=Object(o.a)(t,2),s=c[0],a=c[1],i=Object(n.useState)([]),l=Object(o.a)(i,2),j=(l[0],l[1],Object(n.useState)(!0)),d=Object(o.a)(j,2),m=d[0],u=d[1],h=Object(n.useState)(!1),O=Object(o.a)(h,2),p=O[0],x=O[1],f=Object(n.useState)(!1),v=Object(o.a)(f,2),N=v[0],g=v[1];Object(n.useEffect)((function(){fetch("https://dcblogapi.herokuapp.com/api/post/".concat(e.match.params.id),{credentials:"include"}).then((function(e){return e.json()})).then((function(e){console.log(e),a(e),u(!1)})).catch((function(e){console.log(e)}))}),[]);return m?Object(r.jsx)("div",{className:"loading",children:"Loading"}):N?Object(r.jsx)(b.a,{to:"/"}):Object(r.jsxs)("div",{children:[Object(r.jsxs)("div",{className:"deletePost",children:[Object(r.jsxs)("div",{className:"textContainer",children:[Object(r.jsx)("div",{className:"viewTitle",children:s.title}),Object(r.jsx)("div",{className:"viewText",children:s.text})]}),Object(r.jsx)("div",{className:"viewBottom",children:Object(r.jsxs)("div",{className:"viewDate",children:["Published: ",s.date_formatted]})})]}),Object(r.jsxs)("div",{className:"deleteSection",children:[Object(r.jsx)("button",{onClick:function(){x(!0)},children:"Delete this Post?"}),p?Object(r.jsxs)("div",{className:"deleteRow",children:[Object(r.jsx)("button",{onClick:function(t){t.preventDefault(),fetch("https://dcblogapi.herokuapp.com/api/post/".concat(e.match.params.id),{method:"DELETE",credentials:"include"}).then((function(e){return e.json()})).then((function(e){console.log(e),g(!0)})).catch((function(e){console.log(e)}))},children:"Confirm"}),Object(r.jsx)("button",{onClick:function(){x(!1)},children:"Cancel"})]}):Object(r.jsx)(r.Fragment,{})]})]})},f=function(e){var t=Object(n.useState)({}),c=Object(o.a)(t,2),s=c[0],a=c[1],i=Object(n.useState)([]),l=Object(o.a)(i,2),j=(l[0],l[1],Object(n.useState)(!0)),d=Object(o.a)(j,2),m=(d[0],d[1]),u=Object(n.useState)(!1),h=Object(o.a)(u,2),O=h[0],p=h[1],x=Object(n.useRef)(null),f=Object(n.useRef)(null),v=Object(n.useRef)(null);Object(n.useEffect)((function(){fetch("https://dcblogapi.herokuapp.com/api/post/".concat(e.match.params.id),{credentials:"include"}).then((function(e){return e.json()})).then((function(e){a(e),m(!1)})).catch((function(e){console.log(e)}))}),[]);return O?Object(r.jsx)(b.a,{to:"/post/".concat(e.match.params.id)}):Object(r.jsx)("div",{className:"formContainer",children:Object(r.jsxs)("form",{className:"submitForm",type:"submit",children:[Object(r.jsx)("div",{className:"title",children:"Update Post"}),Object(r.jsx)("label",{htmlFor:"title",children:"Title: "}),Object(r.jsx)("input",{ref:x,type:"text",id:"title",name:"title",defaultValue:s.title}),Object(r.jsx)("label",{htmlFor:"text",children:"Text: "}),Object(r.jsx)("textarea",{ref:f,className:"textArea",type:"text",id:"text",name:"text",defaultValue:s.text}),Object(r.jsxs)("div",{className:"checker",children:[Object(r.jsx)("label",{htmlFor:"checkBox",children:"Publish: "}),Object(r.jsx)("input",{ref:v,type:"checkbox",id:"checkBox",defaultChecked:s.published})]}),Object(r.jsx)("button",{onClick:function(t){t.preventDefault(),fetch("https://dcblogapi.herokuapp.com/api/post/".concat(e.match.params.id),{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:x.current.value,text:f.current.value,published:v.current.checked})}).then((function(e){return e.json()})).then((function(e){console.log(e),p(!0)})).catch((function(e){console.log(e)}))},children:"Update post"})]})})};var v=function(){var e=Object(n.useState)(!1),t=Object(o.a)(e,2),c=t[0],s=t[1];return Object(n.useEffect)((function(){fetch("https://dcblogapi.herokuapp.com/api",{credentials:"include"}).then((function(e){return e.json()})).then((function(e){e.authorized&&s(!0)})).catch((function(e){console.log(e)}))}),[]),Object(r.jsxs)(l.a,{children:[Object(r.jsx)(m,{}),Object(r.jsxs)(b.d,{children:[Object(r.jsx)(b.b,{exact:!0,path:"/",component:d}),Object(r.jsx)(b.b,{exact:!0,path:"/create",component:u}),Object(r.jsx)(b.b,{exact:!0,path:"/post/:id",component:h}),Object(r.jsx)(b.b,{exact:!0,path:"/login",children:Object(r.jsx)(O,{changeAuth:function(){c||s(!0)},auth:c})}),Object(r.jsx)(b.b,{exact:!0,path:"/post/:id/comment/:commentId",component:p}),";",Object(r.jsx)(b.b,{exact:!0,path:"/post/:id/delete",component:x}),Object(r.jsx)(b.b,{exact:!0,path:"/post/:id/update",component:f})]})]})};i.a.render(Object(r.jsx)(s.a.StrictMode,{children:Object(r.jsx)(v,{})}),document.getElementById("root"))}},[[29,1,2]]]);
//# sourceMappingURL=main.786cc99d.chunk.js.map